(window.webpackJsonp=window.webpackJsonp||[]).push([[87],{685:function(t,v,_){"use strict";_.r(v);var e=_(8),a=Object(e.a)({},(function(){var t=this,v=t.$createElement,_=t._self._c||v;return _("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[_("p",[t._v("在线视频地址，MP4")]),t._v(" "),_("p",[t._v("https://v-cdn.zjol.com.cn/280443.mp4"),_("br"),t._v("\nhttps://v-cdn.zjol.com.cn/276982.mp4"),_("br"),t._v("\nhttps://v-cdn.zjol.com.cn/276984.mp4"),_("br"),t._v("\nhttps://v-cdn.zjol.com.cn/276985.mp4")]),t._v(" "),_("h2",{attrs:{id:"ffmpeg常用命令"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#ffmpeg常用命令"}},[t._v("#")]),t._v(" FFmpeg常用命令")]),t._v(" "),_("ul",[_("li",[t._v("基本信息查询命令")]),t._v(" "),_("li",[t._v("录制命令")]),t._v(" "),_("li",[t._v("分解/复用命令")]),t._v(" "),_("li",[t._v("处理原始数据命令")]),t._v(" "),_("li",[t._v("剪裁和合并命令")]),t._v(" "),_("li",[t._v("图片/视频互转命令")]),t._v(" "),_("li",[t._v("直播相关命令")]),t._v(" "),_("li",[t._v("各种滤镜")])]),t._v(" "),_("h4",{attrs:{id:"基本信息查询命令"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#基本信息查询命令"}},[t._v("#")]),t._v(" 基本信息查询命令")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("命令")]),t._v(" "),_("th",{staticStyle:{"text-align":"center"}},[t._v("解释")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("-version")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("显示版本")])]),t._v(" "),_("tr",[_("td",[t._v("-demuxers")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("显示可用的demuxers")])]),t._v(" "),_("tr",[_("td",[t._v("-muxers")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("显示可用的muxers")])]),t._v(" "),_("tr",[_("td",[t._v("-devices")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("显示可用的设备")])]),t._v(" "),_("tr",[_("td",[t._v("-codecs")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("显示所有编解码器")])]),t._v(" "),_("tr",[_("td",[t._v("-decoders")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("显示可用的解码器")])]),t._v(" "),_("tr",[_("td",[t._v("-encoders")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("显示所有的编码器")])]),t._v(" "),_("tr",[_("td",[t._v("-bsfs")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("显示比特流filter")])]),t._v(" "),_("tr",[_("td",[t._v("-formats")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("显示可用的格式")])]),t._v(" "),_("tr",[_("td",[t._v("-protocols")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("显示可用的协议")])]),t._v(" "),_("tr",[_("td",[t._v("-filters")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("显示可用的过滤器")])]),t._v(" "),_("tr",[_("td",[t._v("-pix_fmts")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("显示可用的像素格式")])]),t._v(" "),_("tr",[_("td",[t._v("-sample_fmts")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("显示可用的采样格式")])]),t._v(" "),_("tr",[_("td",[t._v("-layouts")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("显示channel名称")])]),t._v(" "),_("tr",[_("td",[t._v("-colors")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("显示识别的颜色名称")])])])]),t._v(" "),_("h4",{attrs:{id:"录制命令"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#录制命令"}},[t._v("#")]),t._v(" 录制命令")]),t._v(" "),_("p",[t._v('ffmpeg -f avfoundation -list_devices true -i ""')]),t._v(" "),_("ul",[_("li",[_("p",[t._v("录屏"),_("br"),t._v("\nffmpeg -f avfoundation -i 1 -r 30 out.yuv")])]),t._v(" "),_("li",[_("p",[t._v("录音")])])]),t._v(" "),_("p",[t._v("ffmpeg -f avfoundation -i :0 out.wav")]),t._v(" "),_("h4",{attrs:{id:"分解-复用命令"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#分解-复用命令"}},[t._v("#")]),t._v(" 分解/复用命令")]),t._v(" "),_("ul",[_("li",[t._v("多媒体格式转换"),_("br"),t._v("\nffmpeg -i j20.mov -vcodec copy -acodec copy out.mp4")])]),t._v(" "),_("p",[t._v("ffmpeg -i j20.mov -an -vcodec copy  out.h264"),_("br"),t._v("\nffmpeg -i j20.mov -an -acodec copy -vn out.aac")]),t._v(" "),_("h4",{attrs:{id:"处理原始数据命令"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#处理原始数据命令"}},[t._v("#")]),t._v(" 处理原始数据命令")]),t._v(" "),_("ul",[_("li",[t._v("ffmpeg提取YUV数据"),_("br"),t._v("\nffmpeg -i input.mp4 -an -c:v rawvideo -pix_fmt yuv420p out.yuv")])]),t._v(" "),_("p",[t._v("ffplay -s 1024x1080 out.yuv")]),t._v(" "),_("ul",[_("li",[t._v("ffmpeg提取PCM数据"),_("br"),t._v("\nffmpeg -i input.mp4 -vn  -ar 44100 -ac 2 -f s16le  out.pcm")])]),t._v(" "),_("p",[t._v("ffpaly -ar 44100 -ac 2 -f s16le out.pcm")]),t._v(" "),_("h4",{attrs:{id:"剪裁和合并命令"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#剪裁和合并命令"}},[t._v("#")]),t._v(" 剪裁和合并命令")]),t._v(" "),_("ul",[_("li",[_("p",[t._v("裁剪"),_("br"),t._v("\nffmpeg -i in.mp4 -ss 00:00:00 -t 10 out.ts")])]),t._v(" "),_("li",[_("p",[t._v("合并"),_("br"),t._v("\nffmpeg -f concat -i input.txt in.mp4")])])]),t._v(" "),_("h4",{attrs:{id:"图片-视频互转命令"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#图片-视频互转命令"}},[t._v("#")]),t._v(" 图片/视频互转命令")]),t._v(" "),_("ul",[_("li",[t._v("视频转图片")])]),t._v(" "),_("p",[t._v("ffmpeg -i in.mp4 -r 1 -f image2 ./img/image-%3d.jpeg")]),t._v(" "),_("p",[t._v("-r 每秒钟几张"),_("br"),t._v("\n-f 格式")]),t._v(" "),_("ul",[_("li",[t._v("图片转视频")])]),t._v(" "),_("p",[t._v("ffmpeg -i ./img/image-%3d.jpeg ./img/out.mp4")]),t._v(" "),_("h4",{attrs:{id:"直播相关命令"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#直播相关命令"}},[t._v("#")]),t._v(" 直播相关命令")]),t._v(" "),_("ul",[_("li",[t._v("推流"),_("br"),t._v("\nffmpeg -re -i in.mp4 -c copy -f flv rtmp://server/live/streamName")])]),t._v(" "),_("p",[t._v("re:")]),t._v(" "),_("ul",[_("li",[t._v("拉流"),_("br"),t._v("\nffmpeg -i rtmp://server/live/streamName -c copy dump.flv")])]),t._v(" "),_("p",[t._v("-c")]),t._v(" "),_("h4",{attrs:{id:"各种滤镜"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#各种滤镜"}},[t._v("#")]),t._v(" 各种滤镜")]),t._v(" "),_("p",[t._v("ffmpeg -i in.mp4 -vf crop=in_w-200:in_h-200 -c:v libx264 -c:a copy out.mp4")]),t._v(" "),_("p",[t._v("in_w:输入视频的width"),_("br"),t._v("\nin_h:输入视频的height")]),t._v(" "),_("p",[t._v("crop格式：crop=out_w:out_h❌y")]),t._v(" "),_("h2",{attrs:{id:"常见"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#常见"}},[t._v("#")]),t._v(" 常见")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("命令")]),t._v(" "),_("th",{staticStyle:{"text-align":"center"}},[t._v("解释")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("-bitexact")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("使用标准比特率")])]),t._v(" "),_("tr",[_("td",[t._v("-vcodec xvid")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("使用xvid压缩")])]),t._v(" "),_("tr",[_("td",[t._v("-s 320x240")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("指定分辨率")])]),t._v(" "),_("tr",[_("td",[t._v("-r 29.97")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("桢速率")])]),t._v(" "),_("tr",[_("td",[t._v("-bitexact")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("使用标准比特率")])]),t._v(" "),_("tr",[_("td",[t._v("-bitexact")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("使用标准比特率")])]),t._v(" "),_("tr",[_("td",[t._v("-bitexact")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("使用标准比特率")])]),t._v(" "),_("tr",[_("td",[t._v("-bitexact")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("使用标准比特率")])]),t._v(" "),_("tr",[_("td",[t._v("-bitexact")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("使用标准比特率")])])])]),t._v(" "),_("p",[t._v("-b <比特率> 指定压缩比特率，似乎ffmpeg是自动VBR的，指定了就大概是平均比特率，比如768，1500这样的"),_("br"),t._v("\n就是原来默认项目中有的"),_("br"),t._v("\n-qscale <数值> 以<数值>质量为基础的VBR，取值0.01-255，约小质量越好"),_("br"),t._v("\n-qmin <数值> 设定最小质量，与-qmax（设定最大质量）共用，比如-qmin 10 -qmax 31"),_("br"),t._v("\n-sameq 使用和源同样的质量"),_("br"),t._v("\n声音部分"),_("br"),t._v("\n-acodec aac 设定声音编码"),_("br"),t._v("\n-ac <数值> 设定声道数，1就是单声道，2就是立体声，转换单声道的TVrip可以用1（节省一半容量），高品质"),_("br"),t._v("\n的DVDrip就可以用2"),_("br"),t._v("\n-ar <采样率> 设定声音采样率，PSP只认24000"),_("br"),t._v("\n-ab <比特率> 设定声音比特率，前面-ac设为立体声时要以一半比特率来设置，比如192kbps的就设成96，转换"),_("br"),t._v("\n君默认比特率都较小，要听到较高品质声音的话建议设到160kbps（80）以上"),_("br"),t._v("\n-vol <百分比> 设定音量，某些DVDrip的AC3轨音量极小，转换时可以用这个提高音量，比如200就是原来的2倍"),_("br"),t._v("\n这样，要得到一个高画质音质低容量的MP4的话，首先画面最好不要用固定比特率，而用VBR参数让程序自己去"),_("br"),t._v("\n判断，而音质参数可以在原来的基础上提升一点，听起来要舒服很多，也不会太大（看情况调整")]),t._v(" "),_("h2",{attrs:{id:"ffmpeg基本开发"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#ffmpeg基本开发"}},[t._v("#")]),t._v(" FFmpeg基本开发")]),t._v(" "),_("ul",[_("li",[t._v("FFmpeg代码结构")])]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("代码库")]),t._v(" "),_("th",{staticStyle:{"text-align":"center"}},[t._v("解释")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("libavcodec")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("提供了一系列编码器的实现")])]),t._v(" "),_("tr",[_("td",[t._v("libavformat")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("实现了流协议，容器格式及其基本IO访问")])]),t._v(" "),_("tr",[_("td",[t._v("libavutil")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("包括hash器，解码器和各种工具函数")])]),t._v(" "),_("tr",[_("td",[t._v("libavfilter")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("提供各种音视频过滤器")])]),t._v(" "),_("tr",[_("td",[t._v("libavdevice")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("提供访问捕获设备和回放设备的接口")])]),t._v(" "),_("tr",[_("td",[t._v("libavswresample")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("实现了混音和重采样")])]),t._v(" "),_("tr",[_("td",[t._v("libswscale")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("实现了色彩转换和缩放功能")])])])]),t._v(" "),_("ul",[_("li",[t._v("FFmpeg 日志系统")])]),t._v(" "),_("div",{staticClass:"language-c line-numbers-mode"},[_("pre",{pre:!0,attrs:{class:"language-c"}},[_("code",[t._v("include "),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("libavutil"),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("log"),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("h"),_("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),_("span",{pre:!0,attrs:{class:"token function"}},[t._v("av_log_set_level")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("AV_LOG_DEBUG"),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),_("span",{pre:!0,attrs:{class:"token function"}},[t._v("av_log")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),_("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NULL")]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("AV_LOG_INFO"),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),_("span",{pre:!0,attrs:{class:"token string"}},[t._v('"...%s\\n"')]),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("op"),_("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),_("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//日志级别")]),t._v("\nAV_LOG_ERROR\nAV_LOG_WARNING\nAV_LOG_INFO\n")])]),t._v(" "),_("div",{staticClass:"line-numbers-wrapper"},[_("span",{staticClass:"line-number"},[t._v("1")]),_("br"),_("span",{staticClass:"line-number"},[t._v("2")]),_("br"),_("span",{staticClass:"line-number"},[t._v("3")]),_("br"),_("span",{staticClass:"line-number"},[t._v("4")]),_("br"),_("span",{staticClass:"line-number"},[t._v("5")]),_("br"),_("span",{staticClass:"line-number"},[t._v("6")]),_("br"),_("span",{staticClass:"line-number"},[t._v("7")]),_("br"),_("span",{staticClass:"line-number"},[t._v("8")]),_("br")])]),_("ul",[_("li",[t._v("文件删除与重命名")])]),t._v(" "),_("p",[t._v("pkg-config --libs libavformat")]),t._v(" "),_("p",[t._v("avpriv_io_delete(); //删除")]),t._v(" "),_("p",[t._v("avpriv_io_move(); //重命名")]),t._v(" "),_("ul",[_("li",[t._v("操作目录重要结构体")])]),t._v(" "),_("p",[t._v("avio_open_dir();")]),t._v(" "),_("p",[t._v("avio_read_dir();")]),t._v(" "),_("p",[t._v("avio_close_dir();")]),t._v(" "),_("p",[t._v("AVIODirContext：操作目录的上下文"),_("br"),t._v("\nAVIOEntry: 目录项，用于存放文件名字、文件大小等信息")]),t._v(" "),_("p",[t._v("avio_free_directory_entry();")]),t._v(" "),_("ul",[_("li",[_("p",[t._v("多媒体文件的基本概念")]),t._v(" "),_("ul",[_("li",[t._v("多媒体文件其实是个容器")]),t._v(" "),_("li",[t._v("在容器里有很多流(Stream/Track)")]),t._v(" "),_("li",[t._v("每种流是由不同编码器编码的")]),t._v(" "),_("li",[t._v("从流里读出的数据称为包")]),t._v(" "),_("li",[t._v("在一个包中包含一个或者多个帧")])])]),t._v(" "),_("li",[_("p",[t._v("重要的结构体")]),t._v(" "),_("ul",[_("li",[t._v("AVFormatContext")]),t._v(" "),_("li",[t._v("AVStream")]),t._v(" "),_("li",[t._v("AVPacket")])])]),t._v(" "),_("li",[_("p",[t._v("FFmpeg操作流数据的基本步骤"),_("br"),t._v("\n解复用--\x3e获取流--〉读数据包--\x3e释放资源")])]),t._v(" "),_("li",[_("p",[t._v("打印音视频信息")]),t._v(" "),_("ul",[_("li",[t._v("av_register_all()")]),t._v(" "),_("li",[t._v("avformat_open_input()/avformat_close_input()")]),t._v(" "),_("li",[t._v("av_dump_format()")])])]),t._v(" "),_("li",[_("p",[t._v("抽取音频数据")]),t._v(" "),_("ul",[_("li",[t._v("av_init_packet()")]),t._v(" "),_("li",[t._v("av_find_best_stream()")]),t._v(" "),_("li",[t._v("av_read_frame()")]),t._v(" "),_("li",[t._v("av_packet_unref()")])])])]),t._v(" "),_("h4",{attrs:{id:"ffmpeg处理音视频流程"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#ffmpeg处理音视频流程"}},[t._v("#")]),t._v(" ffmpeg处理音视频流程")]),t._v(" "),_("h2",{attrs:{id:"音视频编解码实战"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#音视频编解码实战"}},[t._v("#")]),t._v(" 音视频编解码实战")]),t._v(" "),_("h2",{attrs:{id:"音视频渲染实战"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#音视频渲染实战"}},[t._v("#")]),t._v(" 音视频渲染实战")]),t._v(" "),_("h2",{attrs:{id:"ffmpeg开发播放器核心功能"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#ffmpeg开发播放器核心功能"}},[t._v("#")]),t._v(" FFmpeg开发播放器核心功能")]),t._v(" "),_("h2",{attrs:{id:"android中使用ffmpeg"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#android中使用ffmpeg"}},[t._v("#")]),t._v(" Android中使用FFmpeg")])])}),[],!1,null,null,null);v.default=a.exports}}]);