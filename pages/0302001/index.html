<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Android系统架构详解 | Leo Technology Stack</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/img/favicon.png">
    <script data-ad-client="ca-pub-7828333725993554" async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/icons/logo.png">
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c">
    <meta name="description" content="架构师技术博客,简洁至上, 专注架构师学习与总结, 前端、后端等技术文章。">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/0.styles.3bb95aac.css" as="style"><link rel="preload" href="/assets/js/app.547c0bf0.js" as="script"><link rel="preload" href="/assets/js/6.1a89cbae.js" as="script"><link rel="preload" href="/assets/js/77.0c4cec8c.js" as="script"><link rel="preload" href="/assets/js/8.e2c6a3e6.js" as="script"><link rel="prefetch" href="/assets/js/1.912e3d3a.js"><link rel="prefetch" href="/assets/js/10.82cdb692.js"><link rel="prefetch" href="/assets/js/100.e6df2e13.js"><link rel="prefetch" href="/assets/js/101.53d50b41.js"><link rel="prefetch" href="/assets/js/102.eeabe335.js"><link rel="prefetch" href="/assets/js/103.22c082fd.js"><link rel="prefetch" href="/assets/js/104.1ccf101d.js"><link rel="prefetch" href="/assets/js/105.a3973527.js"><link rel="prefetch" href="/assets/js/106.737c1dc3.js"><link rel="prefetch" href="/assets/js/107.e6b78f77.js"><link rel="prefetch" href="/assets/js/108.b7c7fbfb.js"><link rel="prefetch" href="/assets/js/109.1edc426f.js"><link rel="prefetch" href="/assets/js/11.f1f05bf4.js"><link rel="prefetch" href="/assets/js/110.4b78b142.js"><link rel="prefetch" href="/assets/js/111.801a106f.js"><link rel="prefetch" href="/assets/js/12.3d02dfd5.js"><link rel="prefetch" href="/assets/js/13.255dd60d.js"><link rel="prefetch" href="/assets/js/14.4cc8141e.js"><link rel="prefetch" href="/assets/js/15.77b69c82.js"><link rel="prefetch" href="/assets/js/16.7fb8fa37.js"><link rel="prefetch" href="/assets/js/17.be996721.js"><link rel="prefetch" href="/assets/js/18.7f070e4b.js"><link rel="prefetch" href="/assets/js/19.ceb71ad8.js"><link rel="prefetch" href="/assets/js/20.c3531b2c.js"><link rel="prefetch" href="/assets/js/21.3404c7fe.js"><link rel="prefetch" href="/assets/js/22.d0d9f085.js"><link rel="prefetch" href="/assets/js/23.ea73c53b.js"><link rel="prefetch" href="/assets/js/24.25b44380.js"><link rel="prefetch" href="/assets/js/25.21665fef.js"><link rel="prefetch" href="/assets/js/26.ac6e0f4f.js"><link rel="prefetch" href="/assets/js/27.b0704a94.js"><link rel="prefetch" href="/assets/js/28.6b225f49.js"><link rel="prefetch" href="/assets/js/29.d795e88d.js"><link rel="prefetch" href="/assets/js/30.d22e19e6.js"><link rel="prefetch" href="/assets/js/31.9bd609cb.js"><link rel="prefetch" href="/assets/js/32.89c0f729.js"><link rel="prefetch" href="/assets/js/33.fafb4a50.js"><link rel="prefetch" href="/assets/js/34.27f61e4b.js"><link rel="prefetch" href="/assets/js/35.bdc4c8c5.js"><link rel="prefetch" href="/assets/js/36.17e3324f.js"><link rel="prefetch" href="/assets/js/37.63a8b933.js"><link rel="prefetch" href="/assets/js/38.123fc86e.js"><link rel="prefetch" href="/assets/js/39.f5965d99.js"><link rel="prefetch" href="/assets/js/40.bfd857b2.js"><link rel="prefetch" href="/assets/js/41.8a429091.js"><link rel="prefetch" href="/assets/js/42.b9d2d685.js"><link rel="prefetch" href="/assets/js/43.5f42ec83.js"><link rel="prefetch" href="/assets/js/44.6621bc3d.js"><link rel="prefetch" href="/assets/js/45.38681ba2.js"><link rel="prefetch" href="/assets/js/46.84b74977.js"><link rel="prefetch" href="/assets/js/47.19e048b8.js"><link rel="prefetch" href="/assets/js/48.aa588943.js"><link rel="prefetch" href="/assets/js/49.48893c71.js"><link rel="prefetch" href="/assets/js/50.02ed7ee9.js"><link rel="prefetch" href="/assets/js/51.ee69d07f.js"><link rel="prefetch" href="/assets/js/52.404dc9dc.js"><link rel="prefetch" href="/assets/js/53.0c1601d3.js"><link rel="prefetch" href="/assets/js/54.972c1488.js"><link rel="prefetch" href="/assets/js/55.483ddf87.js"><link rel="prefetch" href="/assets/js/56.2d8dd133.js"><link rel="prefetch" href="/assets/js/57.8b7020b4.js"><link rel="prefetch" href="/assets/js/58.22d8d598.js"><link rel="prefetch" href="/assets/js/59.3e50fd36.js"><link rel="prefetch" href="/assets/js/60.6f3d10bf.js"><link rel="prefetch" href="/assets/js/61.18667437.js"><link rel="prefetch" href="/assets/js/62.75c34c32.js"><link rel="prefetch" href="/assets/js/63.2cb97ac4.js"><link rel="prefetch" href="/assets/js/64.eda63d4b.js"><link rel="prefetch" href="/assets/js/65.10f2fc27.js"><link rel="prefetch" href="/assets/js/66.8052e009.js"><link rel="prefetch" href="/assets/js/67.672f6155.js"><link rel="prefetch" href="/assets/js/68.dacf4f26.js"><link rel="prefetch" href="/assets/js/69.b942721f.js"><link rel="prefetch" href="/assets/js/7.956766b7.js"><link rel="prefetch" href="/assets/js/70.daa27754.js"><link rel="prefetch" href="/assets/js/71.80c17e36.js"><link rel="prefetch" href="/assets/js/72.8d85e956.js"><link rel="prefetch" href="/assets/js/73.8ae40049.js"><link rel="prefetch" href="/assets/js/74.0a72880c.js"><link rel="prefetch" href="/assets/js/75.9014353b.js"><link rel="prefetch" href="/assets/js/76.c9e8bd64.js"><link rel="prefetch" href="/assets/js/78.6d270f46.js"><link rel="prefetch" href="/assets/js/79.4e269ee7.js"><link rel="prefetch" href="/assets/js/80.4f18165f.js"><link rel="prefetch" href="/assets/js/81.fdf05680.js"><link rel="prefetch" href="/assets/js/82.0cb859b5.js"><link rel="prefetch" href="/assets/js/83.2d3d949f.js"><link rel="prefetch" href="/assets/js/84.1aa4e017.js"><link rel="prefetch" href="/assets/js/85.ade9b646.js"><link rel="prefetch" href="/assets/js/86.069bc62a.js"><link rel="prefetch" href="/assets/js/87.51a7429a.js"><link rel="prefetch" href="/assets/js/88.e797c959.js"><link rel="prefetch" href="/assets/js/89.5389c252.js"><link rel="prefetch" href="/assets/js/9.48caeb51.js"><link rel="prefetch" href="/assets/js/90.c581896b.js"><link rel="prefetch" href="/assets/js/91.d353de30.js"><link rel="prefetch" href="/assets/js/92.3105b496.js"><link rel="prefetch" href="/assets/js/93.416765e6.js"><link rel="prefetch" href="/assets/js/94.cb24b172.js"><link rel="prefetch" href="/assets/js/95.4f568635.js"><link rel="prefetch" href="/assets/js/96.43ea0146.js"><link rel="prefetch" href="/assets/js/97.917c1ec8.js"><link rel="prefetch" href="/assets/js/98.68621700.js"><link rel="prefetch" href="/assets/js/99.31b9c418.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.c4af4257.js"><link rel="prefetch" href="/assets/js/vendors~flowchart.558c275c.js"><link rel="prefetch" href="/assets/js/vendors~notification.578d7770.js">
    <link rel="stylesheet" href="/assets/css/0.styles.3bb95aac.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/leo.png" alt="Leo Technology Stack" class="logo"> <span class="site-name can-hide">Leo Technology Stack</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/front/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/front/#Android" class="nav-link">Android</a></li><li class="dropdown-item"><!----> <a href="/front/#Web" class="nav-link">Web</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><a href="/rear/" class="link-title">后端</a> <span class="title" style="display:none;">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/rear/#SpringBoot" class="nav-link">SpringBoot</a></li><li class="dropdown-item"><!----> <a href="/rear/#数据库" class="nav-link">数据库</a></li><li class="dropdown-item"><!----> <a href="/rear/#Docker" class="nav-link">Docker</a></li><li class="dropdown-item"><!----> <a href="/rear/#netty" class="nav-link">Netty</a></li><li class="dropdown-item"><!----> <a href="/rear/#KubeSphere" class="nav-link">KubeSphere</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Linux" class="dropdown-title"><a href="/linux/" class="link-title">Linux</a> <span class="title" style="display:none;">Linux</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/linux/#linux" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/linux/#Android Framework" class="nav-link">Android Framework</a></li><li class="dropdown-item"><!----> <a href="/linux/#开源库" class="nav-link">开源库</a></li></ul></div></div><div class="nav-item"><a href="/thinking/" class="nav-link">思维</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><!----> <span class="title" style="display:;">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/a938d92/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/post/a/" class="nav-link">投资理财</a></li><li class="dropdown-item"><!----> <a href="/post/books/" class="nav-link">杂事记录</a></li><li class="dropdown-item"><h4>索引</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-subitem"><a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-subitem"><a href="/archives/" class="nav-link">归档</a></li></ul></li><li class="dropdown-item"><h4>开源项目</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/markdown/" class="nav-link">Advance Markdown</a></li><li class="dropdown-subitem"><a href="https://github.com/leo94666/AnLibrary" target="_blank" rel="noopener noreferrer" class="nav-link external">
  AnLibrary
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://cdn.pixabay.com/photo/2021/04/22/06/40/duck-6198196_1280.jpg"> <div class="blogger-info"><h3>Leo</h3> <span>不知名的架构师</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/front/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/front/#Android" class="nav-link">Android</a></li><li class="dropdown-item"><!----> <a href="/front/#Web" class="nav-link">Web</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><a href="/rear/" class="link-title">后端</a> <span class="title" style="display:none;">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/rear/#SpringBoot" class="nav-link">SpringBoot</a></li><li class="dropdown-item"><!----> <a href="/rear/#数据库" class="nav-link">数据库</a></li><li class="dropdown-item"><!----> <a href="/rear/#Docker" class="nav-link">Docker</a></li><li class="dropdown-item"><!----> <a href="/rear/#netty" class="nav-link">Netty</a></li><li class="dropdown-item"><!----> <a href="/rear/#KubeSphere" class="nav-link">KubeSphere</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Linux" class="dropdown-title"><a href="/linux/" class="link-title">Linux</a> <span class="title" style="display:none;">Linux</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/linux/#linux" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/linux/#Android Framework" class="nav-link">Android Framework</a></li><li class="dropdown-item"><!----> <a href="/linux/#开源库" class="nav-link">开源库</a></li></ul></div></div><div class="nav-item"><a href="/thinking/" class="nav-link">思维</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><!----> <span class="title" style="display:;">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/a938d92/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/post/a/" class="nav-link">投资理财</a></li><li class="dropdown-item"><!----> <a href="/post/books/" class="nav-link">杂事记录</a></li><li class="dropdown-item"><h4>索引</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-subitem"><a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-subitem"><a href="/archives/" class="nav-link">归档</a></li></ul></li><li class="dropdown-item"><h4>开源项目</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/markdown/" class="nav-link">Advance Markdown</a></li><li class="dropdown-subitem"><a href="https://github.com/leo94666/AnLibrary" target="_blank" rel="noopener noreferrer" class="nav-link external">
  AnLibrary
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Android系统架构详解</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/0302001/#android-8-以后的系统架构" class="sidebar-link">Android 8 以后的系统架构</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/0302001/#应用框架" class="sidebar-link">应用框架</a></li><li class="sidebar-sub-header"><a href="/pages/0302001/#binder-ipc" class="sidebar-link">Binder IPC</a></li><li class="sidebar-sub-header"><a href="/pages/0302001/#系统服务" class="sidebar-link">系统服务</a></li><li class="sidebar-sub-header"><a href="/pages/0302001/#硬件抽象层" class="sidebar-link">硬件抽象层</a></li><li class="sidebar-sub-header"><a href="/pages/0302001/#linux内核" class="sidebar-link">Linux内核</a></li></ul></li><li><a href="/pages/0302001/#android-8-之前的系统架构" class="sidebar-link">Android 8 之前的系统架构</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/0302001/#linux内核-2" class="sidebar-link">Linux内核</a></li><li class="sidebar-sub-header"><a href="/pages/0302001/#系统库-libraries" class="sidebar-link">系统库（Libraries）</a></li><li class="sidebar-sub-header"><a href="/pages/0302001/#android运行环境-android-runtime" class="sidebar-link">Android运行环境（Android Runtime）</a></li><li class="sidebar-sub-header"><a href="/pages/0302001/#应用程序框架层-application-framework" class="sidebar-link">应用程序框架层（Application Framework）</a></li><li class="sidebar-sub-header"><a href="/pages/0302001/#应用程序层" class="sidebar-link">应用程序层</a></li><li class="sidebar-sub-header"><a href="/pages/0302001/#系统服务-2" class="sidebar-link">系统服务</a></li><li class="sidebar-sub-header"><a href="/pages/0302001/#核心服务" class="sidebar-link">核心服务</a></li><li class="sidebar-sub-header"><a href="/pages/0302001/#系统应用" class="sidebar-link">系统应用</a></li></ul></li><li><a href="/pages/0302001/#相关解释" class="sidebar-link">相关解释</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/0302001/#hidl" class="sidebar-link">HIDL</a></li><li class="sidebar-sub-header"><a href="/pages/0302001/#bp文件" class="sidebar-link">.bp文件</a></li><li class="sidebar-sub-header"><a href="/pages/0302001/#rc" class="sidebar-link">.rc</a></li><li class="sidebar-sub-header"><a href="/pages/0302001/#soong" class="sidebar-link">Soong</a></li><li class="sidebar-sub-header"><a href="/pages/0302001/#android-bsp" class="sidebar-link">Android BSP</a></li></ul></li><li><a href="/pages/0302001/#other" class="sidebar-link">Other</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-leo-wrapper "><div class="articleInfo-wrap" data-v-2c5db116><div class="articleInfo" data-v-2c5db116><ul class="breadcrumbs" data-v-2c5db116><li data-v-2c5db116><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-2c5db116></a></li> <li data-v-2c5db116><a href="/categories/?category=notes" title="分类" data-v-2c5db116>notes</a></li> <li data-v-2c5db116><a href="/categories/?category=Linux" title="分类" data-v-2c5db116>Linux</a></li> <li data-v-2c5db116><a href="/categories/?category=Android%20Framework" title="分类" data-v-2c5db116>Android Framework</a></li></ul> <div class="info" data-v-2c5db116><div title="作者" class="author iconfont icon-touxiang" data-v-2c5db116><a href="https://github.com/leo94666" target="_blank" title="作者" class="beLink" data-v-2c5db116>Leo</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-2c5db116><a href="javascript:;" data-v-2c5db116>2021-04-20</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">
          Android系统架构详解
        </h1> <!----> <div class="theme-leo-content content__default"><p>Android 系统源码里编程语言：</p> <ul><li>汇编：bootloader和kernel中可能会用到</li> <li>C语言：这你丫不会，你玩毛的Linux Kernel啊</li> <li>C++：这你丫不会，你就别搞Android底层开发了，HAL和中间库</li> <li>Java：这么再不会就自杀吧，framework和app的代码都是Java的</li> <li>Python：这个不会么也没事，编译相关的</li> <li>Shell：脚本</li> <li>Makefile：肯定会的，不会跳楼吧</li></ul> <h2 id="android-8-以后的系统架构"><a href="#android-8-以后的系统架构" class="header-anchor">#</a> Android 8 以后的系统架构</h2> <p><img src="https://source.android.com/devices/images/ape_fwk_all.png" alt="Android 8"></p> <h3 id="应用框架"><a href="#应用框架" class="header-anchor">#</a> 应用框架</h3> <h3 id="binder-ipc"><a href="#binder-ipc" class="header-anchor">#</a> <a href="http://gityuan.com/2015/10/31/binder-prepare/" target="_blank" rel="noopener noreferrer">Binder IPC<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h3> <h3 id="系统服务"><a href="#系统服务" class="header-anchor">#</a> 系统服务</h3> <h3 id="硬件抽象层"><a href="#硬件抽象层" class="header-anchor">#</a> 硬件抽象层</h3> <h3 id="linux内核"><a href="#linux内核" class="header-anchor">#</a> Linux内核</h3> <h2 id="android-8-之前的系统架构"><a href="#android-8-之前的系统架构" class="header-anchor">#</a> Android 8 之前的系统架构</h2> <p>Android的架构是分层的，非常清晰，分工很明确。<br>
Android本身是一套软件堆叠(Software Stack)，或称为「软件叠层架构」，<br>
叠层主要分成三层：操作系统、中间件、应用程序。<br>
Android系统分为4层，包括：</p> <p><img src="https://i.loli.net/2018/04/04/5ac48d2aef2af.png" alt="fuck.png"></p> <p><img src="https://i.loli.net/2018/05/23/5b04c5f528ca7.png" alt="image001.png"></p> <p>HIDL：HIDL 是用于指定 HAL 与其用户之间接口的一个接口描述语言（Interface Description Language），它允许将指定的类型与函数调用收集到接口（Interface）和包（Package）中。更广泛地说，HIDL 是一个可以让那些独立编译的代码库（Libraries）之间进行通信的系统。 HIDL 实际上是用于进行进程间通信（Inter-process Communication，IPC）的。进程间的通信可以称为 Binder 化（Binderized）。对于必须连接到进程的库，也可以使用 passthough 模式（但在Java中不支持）。 HIDL 将指定的数据结构与方法签名组织到接口中，这些接口又会被收集到包中以供使用。它的语法与 C++、JAVA 是类似的，不过关键字集合不尽相同。其注释风格与 JAVA 是一致的。<br>
AIDL: 接口定义语言，在 Android 中，一个进程通常无法访问另一个进程的内存。因此，为进行通信，进程需将其对象分解成可供操作系统理解的原语，并将其编组为可供您操作的对象。编写执行该编组操作的代码较为繁琐，因此 Android 会使用 AIDL 为您处理此问题。</p> <h3 id="linux内核-2"><a href="#linux内核-2" class="header-anchor">#</a> Linux内核</h3> <div class="language- extra-class"><pre><code>Android的核心系统服务依赖于Linux内核，如

- 安全性
- 内存管理
- 进程管理
- 网络协议栈
- 驱动模型

Linux 内核也同时作为硬件和软件栈之间的抽象层

驱动：
- 显示驱动（Display Driver）
- 摄像头驱动（Camera Driver）
- 键盘驱动（Keypad Driver）
- 蓝牙驱动（Bluetooth Driver）
- WiFi驱动（WIFI Driver）
- Audio驱动（Audio Driver）
- Binder（IPC）驱动
- 电源管理（Power Manager）
- M-Systems驱动
</code></pre></div><h3 id="系统库-libraries"><a href="#系统库-libraries" class="header-anchor">#</a> 系统库（Libraries）</h3> <div class="language- extra-class"><pre><code>Android包含一个C/C++库的集合，供Android系统的各个组件使用。这些功能通过Android的应用程序框架（application framework）暴露给开发者。下面列出一些核心库：

- 界面管理（Surface Manager）
- 多媒体框架（Media Framework）
- SQLite
- 字体引擎（FreeType）
- 图形处理3D库（OpenGL|ES）
- SGL
- 浏览器（WebKit）
- 安全套接层（SSL）
- C库
</code></pre></div><h3 id="android运行环境-android-runtime"><a href="#android运行环境-android-runtime" class="header-anchor">#</a> Android运行环境（Android Runtime）</h3> <div class="language- extra-class"><pre><code>- Core Libraries 
- Dalvik Virtual Machine 

Core Libraries 提供大部分在Java编程语言核心类库中可用的功能


Dalvik Virtual Machine，每一个Android应用程序是Dalvik虚拟机中的实例，运行在他们自己 的进程中。Dalvik虚拟机设计成，在一个设备可以高效地运行多个虚拟机。Dalvik虚拟机可执行文件格式是.dex，dex格式是专为Dalvik 设计的一种压缩格式，适合内存和处理器速度有限的系统。大多数虚拟机包括JVM都是基于栈的，而Dalvik虚拟机则是基于寄存器的。 两种架构各有优劣，一般而言，基于栈的机器需要更多指令，而基于寄存器的机器指令更大。dx 是一套工具，可以將 Java .class 转换成 .dex 格式。一个dex文件通常会有多个.class。由于dex有時必须进行最佳化，会使文件大小增加1-4倍，以ODEX结尾。Dalvik虚拟机依赖于Linux 内核提供基本功能，如线程和底层内存管理。
</code></pre></div><h3 id="应用程序框架层-application-framework"><a href="#应用程序框架层-application-framework" class="header-anchor">#</a> 应用程序框架层（Application Framework）</h3> <div class="language- extra-class"><pre><code>Android的应用程序框架为应用程序层的开发者提供APIs，它实际上是一个应用程序的框架,应用程序的体系结构旨在简化组件的重用，任何应用程序都能发布他的功能且任何其他应用程序可以使用这些功能（需要服从框架执行的安全限制）。这一机制允许用户替换组件。。由于上层的应用程序是以JAVA构建的，因此本层次提供的首先包含了UI程序中所需要的各种控件：例如： Views (视图组件)包括 lists(列表), grids(栅格), text boxes(文本框), buttons(按钮)等。甚至一个嵌入式的Web浏览器。

- [活动管理器(Activity Manager Services)](\framework\ActivityManager.md)
- [窗口管理器（Window Manager Services）]()
- [内容提供者（Content Providers）]()
- [视图系统（View Systems）]()
- [通知管理器（Notification Manager）]()
- [包管理器（Package Manager）]()
- [电话管理器（Telephony Manager）]()
- [资源管理器（Resource Manager）]()
- [定位管理层（Location Manager）]()
- [XMPP Service]()
</code></pre></div><h3 id="应用程序层"><a href="#应用程序层" class="header-anchor">#</a> 应用程序层</h3> <p>Android的应用程序主要是用户界面（User Interface）方面的，通常以JAVA程序编写，其中还可以包含各种资源文件（放置在res目录中）JAVA程序及相关资源经过编译后，将生成一个APK包。<br>
Android本身提供了主屏幕（Home），联系人（Contact），电话（Phone），浏览器（Browers）等众多的核心应用。<br>
同时应用程序的开发者还可以使用应用程序框架层的API实现自己的程序。这也是Android开源的巨大潜力的体现。</p> <h3 id="系统服务-2"><a href="#系统服务-2" class="header-anchor">#</a> 系统服务</h3> <p>SystemServer 是framework中非常重要的一个进程，它是在虚拟机启动后运行的第一个java进程，SystemServer启动其他系统服务，这些系统服务都是以一个线程的方式存在于SystemServer进程中。</p> <ul><li><p>EntropyService	提供伪随机数</p></li> <li><p>PowerManagerService	电源管理服务</p></li> <li><p>ActivityManagerService	最核心的服务之一，管理Activity</p></li> <li><p>TelephonyRegistry	通过该服务注册电话模块的事件响应，比如重启、关闭、启动等</p></li> <li><p>PackageManagerService	程序包管理服务</p></li> <li><p>AccountManagerService	账户管理服务，是指联系人账户，而不是Linux系统的账户</p></li> <li><p>ContentService	ContentProvider服务，提供跨进程数据交换</p></li> <li><p>BatteryService	电池管理服务</p></li> <li><p>LightsService	自然光强度感应传感器服务</p></li> <li><p>VibratorService	震动器服务</p></li> <li><p>AlarmManagerService	定时器管理服务，提供定时提醒服务</p></li> <li><p>WindowManagerService	Framework最核心的服务之一，负责窗口管理</p></li> <li><p>BluetoothService	蓝牙服务</p></li> <li><p>DevicePolicyManagerService	提供一些系统级别的设置及属性</p></li> <li><p>StatusBarManagerService	状态栏管理服务</p></li> <li><p>ClipboardService	系统剪切板服务</p></li> <li><p>InputMethodManagerService	输入法管理服务</p></li> <li><p>NetStatService	网络状态服务</p></li> <li><p>NetworkManagementService	网络管理服务</p></li> <li><p>ConnectivityService	网络连接管理服务</p></li> <li><p>AccessibilityManagerService	辅助管理程序截获所有的用户输入，并根据这些输入给用户一些额外的反馈，起到辅助的效果</p></li> <li><p>MountService	挂载服务，可通过该服务调用Linux层面的mount程序</p></li> <li><p>NotificationManagerService	通知栏管理服务，Android中的通知栏和状态栏在一起，只是界面上前者在左边，后者在右边</p></li> <li><p>DeviceStorageMonitorService	磁盘空间状态检测服务</p></li> <li><p>LocationManagerService	地理位置服务</p></li> <li><p>SearchManagerService	搜索管理服务</p></li> <li><p>DropBoxManagerService	通过该服务访问Linux层面的Dropbox程序</p></li> <li><p>WallpaperManagerService	墙纸管理服务，墙纸不等同于桌面背景，在View系统内部，墙纸可以作为任何窗口的背景</p></li> <li><p>AudioService	音频管理服务</p></li> <li><p>BackupManagerService	系统备份服务</p></li> <li><p>AppWidgetService	        Widget服务</p></li> <li><p>RecognitionManagerService	身份识别服务</p></li> <li><p>DiskStatsService	磁盘统计服务</p></li></ul> <h3 id="核心服务"><a href="#核心服务" class="header-anchor">#</a> 核心服务</h3> <ul><li>ActivityManagerService</li> <li>WindowManagerService</li> <li>Android Graphics系统
<ul><li>Surfaceflinger</li> <li>PackageManagerService</li> <li>Input系统</li></ul></li></ul> <h3 id="系统应用"><a href="#系统应用" class="header-anchor">#</a> 系统应用</h3> <ul><li>System UI</li> <li>Launcher</li></ul> <h2 id="相关解释"><a href="#相关解释" class="header-anchor">#</a> 相关解释</h2> <h3 id="hidl"><a href="#hidl" class="header-anchor">#</a> HIDL</h3> <p>HIDL 读作 hide-l，全称是 Hardware Interface Definition Language。它在 Android Project Treble 中被起草，在 Android 8.0 中被全面使用，其诞生目的是<strong>使 Android 可以在不重新编译 HAL 的情况下对 Framework 进行 OTA 升级</strong></p> <p>使用 HIDL 描述的 HAL 描述文件替换旧的用头文件描述的 HAL 文件的过程称为 *** HAL 的 binder 化（binderization）。所有运行 Android O 的设备都必须只支持 binder 化后的 HAL 模块。**<br>
　　已发布的 HIDL package包位于 Android 代码库的hardware/interfaces/或vendor/vendorName目录下。使用 HDIL 描述的 HAL 接口存放在这些目录下的.hal文件中。比如我们可以在hardware/interfaces/audio/2.0/目录下找到部分 Audio HAL 描述文件</p> <h3 id="bp文件"><a href="#bp文件" class="header-anchor">#</a> .bp文件</h3> <p>Android.bp是用来替换Android.mk的配置文件，它使用<a href="https://github.com/google/blueprint/" target="_blank" rel="noopener noreferrer">Blueprint<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>框架来解析。Blueprint是生成、解析Android.bp的工具，是Soong的一部分。Soong则是专为Android编译而设计的工具，Blueprint只是解析文件的形式，而Soong则解释内容的含义，最终转换成<a href="https://ninja-build.org/" target="_blank" rel="noopener noreferrer">Ninja<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>文件。</p> <h3 id="rc"><a href="#rc" class="header-anchor">#</a> .rc</h3> <h3 id="soong"><a href="#soong" class="header-anchor">#</a> Soong</h3> <p><a href="https://android.googlesource.com/platform/build/soong/" target="_blank" rel="noopener noreferrer">Soong<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="android-bsp"><a href="#android-bsp" class="header-anchor">#</a> Android BSP</h3> <p>Android BSP， 基本可以理解为：</p> <ul><li>linux 驱动</li> <li>linux BSP （CPU，电源管理比驱动更深入的硬件支持包）</li> <li>Android HAL层</li></ul> <p>首先，熟悉linux kernel，linux driver的基本架构，熟悉C语言，懂得基本硬件知识，能看懂电路图。<br>
其次，要熟悉linux系统编程，因为很多HAL层或者一些硬件的适配需要编写应用层软件来适配，尤其是Android定制性比较高。<br>
再次，需要了解构建Android环境需要的知识，如makefile，打包，烧写等知识。</p> <h2 id="other"><a href="#other" class="header-anchor">#</a> Other</h2> <ul><li>adb命令</li> <li>Handler</li> <li>Activity启动流程</li> <li>Binder机制</li> <li>AIDL原理</li> <li>Android图像显示相关流程，VSync信号，SurfaceFlinger到FrameBuffer</li> <li>App启动模式</li></ul></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.com/leo94666/leo94666.github.io/edit/master/docs/notes/03.Linux/02.Android Framework/001.Android系统架构详解.md" target="_blank" rel="noopener noreferrer">编辑此页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022-04-28, 11:21:32</span></div></div> <div class="page-nav-wapper"><!----> <!----></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:719947897@qq.com" title="发邮件" target="_blank" class="iconfont icon-email"></a><a href="https://github.com/leo94666" title="客官，给个Star吧，≥Ö‿Ö≤" target="_blank" class="iconfont icon-github"></a></div> 
  Theme by
  <a href="https://github.com/leo94666" target="_blank" title="本站主题">Leo</a> 
    | Copyright © 2016-2022
    <span>Leo | <a href="https://github.com/leo94666/leo94666.github.io/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-back-to-top" style="display:none;"></div> <div title="赏" class="button blur shang iconfont icon-shang"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-comment" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-theme"><ul class="select-box" style="display:none;"><li class="iconfont icon-auto">
          跟随系统
        </li><li class="iconfont icon-light">
          浅色模式
        </li><li class="iconfont icon-dark">
          深色模式
        </li><li class="iconfont icon-read">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div><div class="el-dialog__wrapper" style="display:none;" data-v-2068c05d data-v-2068c05d><div role="dialog" aria-modal="true" aria-label="dialog" class="el-dialog el-dialog--center" style="margin-top:35vh;width:0px;"><div class="el-dialog__header"><span class="el-dialog__title"></span><button type="button" aria-label="Close" class="el-dialog__headerbtn"><i class="el-dialog__close el-icon el-icon-close"></i></button></div><!----><!----></div></div><!----></div></div>
    <script src="/assets/js/app.547c0bf0.js" defer></script><script src="/assets/js/6.1a89cbae.js" defer></script><script src="/assets/js/77.0c4cec8c.js" defer></script><script src="/assets/js/8.e2c6a3e6.js" defer></script>
  </body>
</html>
